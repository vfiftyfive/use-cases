apiVersion: mongodbcommunity.mongodb.com/v1
kind: MongoDBCommunity
metadata:
  name: mongodb
spec:
  members: 3
  security:
    authentication:
      modes:
      - SCRAM
  statefulSet:
    spec:
      selector: {}
      template:
        spec:
          containers:
            - name: "mongodb-agent"
              resources:
                requests:
                  cpu: 100m
                  memory: 100M
                limits:
                  cpu: 500m
                  memory: 500M
            - name: "mongod"
              resources:
                requests:
                  cpu: 100m
                  memory: 500M
                limits:
                  cpu: 1000m
                  memory: 1000M  
      serviceName: mongodb
      volumeClaimTemplates:
      - metadata:
          name: data-volume
        spec:
          accessModes:
          - ReadWriteOnce
          resources:
            requests:
              storage: 1Gi
          storageClassName: ondat-replicated
      - metadata:
          name: logs-volume
        spec:
          accessModes:
          - ReadWriteOnce
          resources:
            requests:
              storage: 1Gi
          storageClassName: ondat-replicated
  type: ReplicaSet
  users:
  - db: admin
    name: admin
    passwordSecretRef:
      name: admin-password-df8t2cdf9f
    roles:
    - db: admin
      name: clusterAdmin
    - db: admin
      name: userAdminAnyDatabase
    - db: admin
      name: dbAdminAnyDatabase
    - db: admin
      name: readWriteAnyDatabase
    scramCredentialsSecretName: admin
  version: 5.0.5
---
apiVersion: v1
data:
  password: bW9uZ28=
kind: Secret
metadata:
  name: admin-password-df8t2cdf9f
type: Opaque

